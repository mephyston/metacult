[{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/index.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/auth/better-auth.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/cache/cache.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[960,963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[960,963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":75,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { redisClient } from '../redis/redis.client';\n\nexport class CacheService {\n    private redis = redisClient;\n    private defaultTtl = 3600; // 1 hour default\n\n    /**\n     * R√©cup√®re une valeur typ√©e du cache.\n     * @template T\n     * @param {string} key - Cl√© Redis.\n     * @returns {Promise<T | null>} La donn√©e d√©s√©rialis√©e ou null.\n     */\n    async get<T>(key: string): Promise<T | null> {\n        try {\n            const data = await this.redis.get(key);\n            if (!data) return null;\n            return JSON.parse(data) as T;\n        } catch (error) {\n            console.warn(`‚ö†Ô∏è Cache GET failed for key \"${key}\":`, error);\n            return null; // Fail Open\n        }\n    }\n\n    /**\n     * Stocke une valeur dans le cache avec un TTL.\n     * @param {string} key - Cl√©.\n     * @param {any} value - Donn√©e √† s√©rialiser.\n     * @param {number} ttlSeconds - Dur√©e de vie en secondes (d√©faut 1h).\n     */\n    async set(key: string, value: any, ttlSeconds: number = this.defaultTtl): Promise<void> {\n        try {\n            const serialized = JSON.stringify(value);\n            await this.redis.set(key, serialized, 'EX', ttlSeconds);\n        } catch (error) {\n            console.warn(`‚ö†Ô∏è Cache SET failed for key \"${key}\":`, error);\n        }\n    }\n\n    /**\n     * Supprime une cl√© du cache.\n     */\n    async del(key: string): Promise<void> {\n        try {\n            await this.redis.del(key);\n        } catch (error) {\n            console.warn(`‚ö†Ô∏è Cache DEL failed for key \"${key}\":`, error);\n        }\n    }\n\n    /**\n     * Pattern Cache-Aside (Look-Aside).\n     * 1. Cherche dans le cache.\n     * 2. Si absent (Miss), ex√©cute la fonction `fetcher` (Source of Truth).\n     * 3. Met en cache le r√©sultat et le retourne.\n     * \n     * Tol√©rance aux pannes (Fail-Open) : Si Redis est down, ex√©cute directement le fetcher.\n     * \n     * @template T\n     * @param {string} key - Cl√© de cache.\n     * @param {() => Promise<T>} fetcher - Fonction asynchrone pour r√©cup√©rer la donn√©e fra√Æche.\n     * @param {number} ttlSeconds - TTL.\n     * @returns {Promise<T>} Le r√©sultat (du cache ou de la source).\n     */\n    async getOrSet<T>(\n        key: string,\n        fetcher: () => Promise<T>,\n        ttlSeconds: number = this.defaultTtl\n    ): Promise<T> {\n        // 1. Try to get from cache\n        try {\n            const cached = await this.get<T>(key);\n            if (cached !== null) {\n                return cached;\n            }\n        } catch (error) {\n            console.warn(`‚ö†Ô∏è Cache retrieval error, bypassing cache for key \"${key}\"`);\n        }\n\n        // 2. Cache MISS: Execute fetcher\n        const result = await fetcher();\n\n        // 3. Set cache (Fail safe)\n        if (result !== undefined && result !== null) {\n            // We await here to ensure data is likely cached, but we verify set errors inside set()\n            await this.set(key, result, ttlSeconds);\n        }\n\n        return result;\n    }\n}\n\nexport const cacheService = new CacheService();\n// console.log('‚úÖ [Infrastructure] CacheService Initialized', !!cacheService);\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/context/request-context.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/client.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2015,2018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2015,2018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { drizzle } from 'drizzle-orm/node-postgres';\nimport { Pool } from 'pg';\nimport * as schema from './schema';\nimport * as authSchema from './schema/auth.schema';\nimport { DefaultLogger, type LogWriter } from 'drizzle-orm/logger';\nimport { requestContext } from '../context/request-context';\n\nexport class TracingLogger extends DefaultLogger {\n    constructor() {\n        super({ writer: new TracingLogWriter() });\n    }\n}\n\nclass TracingLogWriter implements LogWriter {\n    write(message: string) {\n        const requestId = requestContext.getRequestId();\n        const prefix = requestId ? `[Req: ${requestId}] ` : '';\n        console.log(`${prefix}${message}`);\n    }\n}\n\nlet pool: Pool;\nlet db: ReturnType<typeof drizzle>;\n\n/**\n * Initialise ou r√©cup√®re la connexion Singleton √† la base de donn√©es PostgreSQL via Drizzle ORM.\n * Combine le sch√©ma de base et les sch√©mas d'authentification ou personnalis√©s.\n * \n * @param {T} customSchema - Sch√©ma additionnel optionnel.\n * @returns {{ pool: Pool, db: NodePgDatabase }} L'instance du pool et de Drizzle.\n */\nexport function getDbConnection<T extends Record<string, unknown>>(customSchema?: T) {\n    if (!pool) {\n        // console.log('üîå Connexion √† la base de donn√©es...'); // Too verbose\n        const isProduction = process.env.NODE_ENV === 'production';\n        const connectionString = process.env.DATABASE_URL;\n        // console.log(`üîå Connexion DB (taille URL: ${connectionString?.length || 0})`);\n\n        pool = new Pool({\n            connectionString,\n            ssl: isProduction ? { rejectUnauthorized: false } : undefined,\n        });\n\n        // ... inside getDbConnection\n        const finalSchema = customSchema ? { ...schema, ...authSchema, ...customSchema } : { ...schema, ...authSchema };\n        const enableLogger = process.env.NODE_ENV !== 'production' || process.env.DEBUG_SQL === 'true';\n        db = drizzle(pool, {\n            schema: finalSchema,\n            logger: enableLogger ? new TracingLogger() : undefined\n        }) as any;\n    }\n    return { pool, db };\n}\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/migrate.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/schema.ts","messages":[{"ruleId":"@nx/enforce-module-boundaries","severity":2,"message":"Projects cannot be imported by a relative or absolute path, and must begin with a npm scope","line":7,"column":1,"nodeType":"ExportAllDeclaration","messageId":"noRelativeOrAbsoluteImportsAcrossLibraries","endLine":7,"endColumn":83}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Export all schemas\nexport * from './schema/auth.schema';\n// export * from './schema/media.schema'; // Moved to Catalog\nexport * from './schema/users.schema';\nexport * from './schema/relations';\n\nexport * from '../../../../interaction/src/infrastructure/db/interactions.schema'; // Interaction Module Schema\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/schema/auth.schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/schema/relations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/schema/users.schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/scripts/reset-db.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/db/seed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/logger/console-patch.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[285,288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[285,288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[725,728],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[725,728],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[813,816],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[813,816],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":24,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[902,905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[902,905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[992,995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[992,995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { requestContext } from '../context/request-context';\n\nexport function patchConsole() {\n    const originalLog = console.log;\n    const originalInfo = console.info;\n    const originalWarn = console.warn;\n    const originalError = console.error;\n\n    function formatMessage(args: any[]) {\n        const requestId = requestContext.getRequestId();\n        const prefix = requestId ? `[Req: ${requestId}]` : '';\n\n        // If first arg is string, prepend. Otherwise unshift.\n        if (args.length > 0 && typeof args[0] === 'string') {\n            args[0] = `${prefix} ${args[0]}`.trim();\n        } else if (requestId) {\n            args.unshift(prefix);\n        }\n        return args;\n    }\n\n    console.log = (...args: any[]) => originalLog.apply(console, formatMessage(args));\n    console.info = (...args: any[]) => originalInfo.apply(console, formatMessage(args));\n    console.warn = (...args: any[]) => originalWarn.apply(console, formatMessage(args));\n    console.error = (...args: any[]) => originalError.apply(console, formatMessage(args));\n}\n","usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/queue/queue.client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]},{"filePath":"/Users/david/Lab/metacult/metacult/libs/backend/infrastructure/src/lib/redis/redis.client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"@typescript-eslint/no-empty-interface","replacedBy":["@typescript-eslint/no-empty-object-type"],"info":{"deprecatedSince":"8.0.0","replacedBy":[{"rule":{"name":"@typescript-eslint/no-empty-object-type","url":"https://typescript-eslint.io/rules/no-empty-object-type"}}],"url":"https://github.com/typescript-eslint/typescript-eslint/pull/8977"}}]}]